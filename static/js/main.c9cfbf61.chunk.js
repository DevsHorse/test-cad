(this["webpackJsonptest-task-cad"]=this["webpackJsonptest-task-cad"]||[]).push([[0],{19:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var i=n(4),s=n.n(i),a=n(14),r=n.n(a),c=(n(19),n(0)),o=n(1),l=n(8),u=n(6),h=n(5),v=n(9),f=n(11),d=n(2),_=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this,e)).realMousePosition={x:0,y:0},i.startDraw=!1,i.isCollapsed=!1,i.canvas.addEventListener("click",(function(e){return i.mouseClick(e)})),i.canvas.addEventListener("mousemove",(function(e){return i.mouseMove(e)})),i.canvas.addEventListener("contextmenu",(function(e){return i.contextmenuClick(e)})),i}return Object(o.a)(n,[{key:"mouseClick",value:function(e){this.startDraw=!this.startDraw}},{key:"mouseMove",value:function(e){var t=this.canvas.getBoundingClientRect();this.realMousePosition={x:e.clientX-t.left,y:e.clientY-t.top}}},{key:"contextmenuClick",value:function(e){e.preventDefault(),this.startDraw=!1}},{key:"toggleEventsDisable",value:function(){this.isCollapsed=!this.isCollapsed}}]),n}(function(){function e(t){Object(c.a)(this,e),this._canvas=void 0,this._ctx=void 0,this._canvas=t,this._ctx=this._canvas.getContext("2d")}return Object(o.a)(e,[{key:"canvas",get:function(){return this._canvas}},{key:"ctx",get:function(){return this._ctx}},{key:"setSettings",value:function(e,t){this._ctx&&(this._ctx.canvas.width=e,this._ctx.canvas.height=t,this._ctx.lineWidth=1,this._ctx.fillStyle="#f11d1d")}},{key:"clear",value:function(){this._ctx&&this._ctx.clearRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}}]),e}()),p=function(){function e(t){Object(c.a)(this,e),this._element=void 0,this._element=t}return Object(o.a)(e,[{key:"render",value:function(e){var t=e.ctx;null!=t&&(t.beginPath(),t.arc(this._element.x,this._element.y,5,0,2*Math.PI,!1),t.fill(),t.stroke())}}]),e}(),y=function(){function e(t,n){Object(c.a)(this,e),this.x=void 0,this.y=void 0,this._renderer=new p(this),this.x=t,this.y=n}return Object(o.a)(e,[{key:"renderer",get:function(){return this._renderer}}]),e}(),m=function(){function e(t){Object(c.a)(this,e),this._element=void 0,this._element=t}return Object(o.a)(e,[{key:"render",value:function(e){var t=e.ctx;null!=t&&(t.beginPath(),t.moveTo(this._element.p1.x,this._element.p1.y),t.lineTo(this._element.p2.x,this._element.p2.y),t.stroke())}}]),e}(),b=function(){function e(t,n){Object(c.a)(this,e),this._p1=void 0,this._p2=void 0,this._p1=t,this._p2=n}return Object(o.a)(e,[{key:"A",get:function(){return this._p2.y-this._p1.y}},{key:"B",get:function(){return this._p2.x-this._p1.x}},{key:"getPointOffset",value:function(e){return new y(this._p1.x+this.B*e,this._p1.y+this.A*e)}},{key:"getCrossPoint",value:function(e){var t=this.getCrossLinePoint(e);return t&&this.between(t.x,this._p1.x,this._p2.x)&&this.between(t.x,e._p1.x,e._p2.x)&&this.between(t.y,this._p1.y,this._p2.y)&&this.between(t.y,e._p1.y,e._p2.y)?t:null}},{key:"getCrossLinePoint",value:function(e){var t=this._p1.x,n=this._p1.y,i=this._p2.x,s=this._p2.y,a=e._p1.x,r=e._p1.y,c=e._p2.x,o=e._p2.y,l=n-s,u=i-t,h=r-o,v=c-a,f=l*v-h*u;if(0!=f){var d=s*t-i*n,_=o*a-c*r;return new y((u*_-v*d)/f,(h*d-l*_)/f)}return null}},{key:"between",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.001,s=Math.min.apply(Math,[t,n]),a=Math.max.apply(Math,[t,n]);return e+i>s&&e<a+i}}],[{key:"getLinesIntersects",value:function(e){for(var t=[],n=0;n<e.length;n++)for(var i=n+1;i<e.length;i++){var s=e[n].line.getCrossPoint(e[i].line);s&&t.push(s)}return t}}]),e}(),k=function(){function e(t,n){Object(c.a)(this,e),this._line=void 0,this._renderer=new m(this),this._line=new b(t,n)}return Object(o.a)(e,[{key:"p1",get:function(){return this._line._p1},set:function(e){this._line._p1=e}},{key:"p2",get:function(){return this._line._p2},set:function(e){this._line._p2=e}},{key:"line",get:function(){return this._line}},{key:"renderer",get:function(){return this._renderer}},{key:"shorten",value:function(e){var t=this._line.getPointOffset(e),n=this._line.getPointOffset(1-e);this.p1=t,this.p2=n}}]),e}(),x=n(13),j=function(){function e(){Object(c.a)(this,e),this._elements=[],this._intersectPoints=[]}return Object(o.a)(e,[{key:"lastElement",get:function(){return this._elements[this._elements.length-1]}},{key:"elements",get:function(){return this._elements}},{key:"setPoints",value:function(){this._intersectPoints=b.getLinesIntersects(this._elements)}},{key:"addElement",value:function(e){this._elements.push(e)}},{key:"moveLastLine",value:function(e){this._elements[this._elements.length-1].p2=e,this.setPoints()}},{key:"deleteLastElement",value:function(){this._elements.pop(),this.setPoints()}},{key:"clear",value:function(){this._elements=[]}},{key:"render",value:function(e){var t=[].concat(Object(x.a)(this._elements),Object(x.a)(this._intersectPoints));e.clear();var n,i=Object(v.a)(t);try{for(i.s();!(n=i.n()).done;){n.value.renderer.render(e)}}catch(s){i.e(s)}finally{i.f()}}}]),e}(),O=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(c.a)(this,n);for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return(e=t.call.apply(t,[this].concat(s)))._document=new j,e}return Object(o.a)(n,[{key:"mouseClick",value:function(e){this.isCollapsed||(this.startDraw||this.addNewLine(),Object(f.a)(Object(d.a)(n.prototype),"mouseClick",this).call(this,e))}},{key:"addNewLine",value:function(){var e=new y(this.realMousePosition.x,this.realMousePosition.y),t=new k(e,e);this._document.addElement(t)}},{key:"mouseMove",value:function(e){this.isCollapsed||(Object(f.a)(Object(d.a)(n.prototype),"mouseMove",this).call(this,e),this.startDraw&&this._document.moveLastLine(new y(this.realMousePosition.x,this.realMousePosition.y)),this.render())}},{key:"contextmenuClick",value:function(e){this.startDraw&&this._document.deleteLastElement(),Object(f.a)(Object(d.a)(n.prototype),"contextmenuClick",this).call(this,e)}},{key:"collapseHandler",value:function(){var e=this;if(!this.isCollapsed){this.toggleEventsDisable();var t=null;t=requestAnimationFrame((function n(){t=requestAnimationFrame(n);var i,s=Object(v.a)(e._document.elements);try{for(s.s();!(i=s.n()).done;){i.value.shorten(.016666666666666666)}}catch(a){s.e(a)}finally{s.f()}e._document.setPoints(),e.render()})),setTimeout((function(){cancelAnimationFrame(t),e._document.clear(),e.render(),e.toggleEventsDisable()}),3e3)}}},{key:"render",value:function(){this._document&&this._document.render(this)}}]),n}(_),g=n(3),w=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var i;return Object(c.a)(this,n),(i=t.call(this,e)).canvasWrapper=null,i.board=void 0,i.collapseHandler=i.collapseHandler.bind(Object(l.a)(i)),i}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var e=new O(document.createElement("canvas"));e.setSettings(1e3,500),this.canvasWrapper.appendChild(e.canvas),this.board=e}},{key:"collapseHandler",value:function(e){e.preventDefault(),this.board.collapseHandler()}},{key:"render",value:function(){var e=this;return Object(g.jsxs)("div",{className:"App",children:[Object(g.jsx)("div",{className:"container",ref:function(t){return e.canvasWrapper=t}}),Object(g.jsx)("button",{className:"collapse-btn",onClick:this.collapseHandler,children:"Collapse lines"})]})}}]),n}(s.a.Component);r.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(w,{})}),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.c9cfbf61.chunk.js.map